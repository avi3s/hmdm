<!-- Localization completed -->
<div ng-show='errorMessage' class='modal-header'>
    <div ng-show='errorMessage' class='error'><span>{{errorMessage}}</span></div>
</div>
<div class='modal-body'>
    <form class='form-horizontal'>


        <div class='form-group'>
            <label class='col-sm-4 control-label' localized>plugin.messaging.label.scope</label>
            <div class='col-sm-8'>
                <select class='form-control'
                        ng-model='message.scope'>
                    <option ng-value="'device'" ng-selected="true"
                            localized>plugin.messaging.scope.device</option>
                    <option ng-value="'group'"
                            localized>plugin.messaging.scope.group</option>
                    <option ng-value="'configuration'"
                            localized>plugin.messaging.scope.configuration</option>
                    <option ng-value="'all'"
                            localized>plugin.messaging.scope.all</option>
                </select>
            </div>
        </div>

        <div class="form-group" ng-if="message.scope == 'device'">
            <label class='col-sm-4 control-label' localized>plugin.messaging.label.device</label>
            <div class="col-sm-8">
                <input type="text"
                       ng-model="message.deviceNumber"
                       localized-placeholder="search.placeholder.device"
                       autocomplete="off"
                       class="form-control"
                       typeahead="device for device in getDevices($viewValue)"
                       typeahead-loading="loadingDevices"
                       typeahead-wait-ms="300"
                       typeahead-focus-first="false"
                       typeahead-input-formatter="deviceLookupFormatter($model)"
                       typeahead-no-results="noResults"/>
            </div>
        </div>

        <div class='form-group' ng-if="message.scope == 'group'">
            <label class='col-sm-4 control-label' localized>plugin.messaging.label.group</label>
            <div class='col-sm-8'>
                <select class='form-control'
                        ng-model='message.groupId'
                        ng-options="group.id as group.name for group in groups">
                </select>
            </div>
        </div>

        <div class='form-group' ng-if="message.scope == 'configuration'">
            <label class='col-sm-4 control-label' localized>plugin.messaging.label.configuration</label>
            <div class='col-sm-8'>
                <select class='form-control'
                        ng-model='message.configurationId'
                        ng-options="configuration.id as configuration.name for configuration in configurations">
                </select>
            </div>
        </div>

        <div class='form-group'>
            <label class='col-sm-4 control-label' localized>plugin.messaging.label.message</label>
            <div class='col-sm-8'>
                <textarea ng-model='message.message' class='form-control no-resize' rows="5"></textarea>
            </div>
        </div>

        <div class='form-group'>
            <div class='col-sm-offset-3 col-sm-9'>
                <button type='submit' class='btn btn-default' ng-click='send()' ng-disabled="sending" localized>plugin.messaging.button.send</button>
                <button type='button' class='btn btn-default' ng-click='closeModal()' localized>button.cancel</button>
            </div>
        </div>
    </form>
</div>
